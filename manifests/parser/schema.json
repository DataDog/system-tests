{
  "type": "object",

  "properties": {
    "tests/": { "$ref": "#/$defs/folder_content" }
  },

  "$defs": {
    "folder_content": {
      "type": "object",
      "patternProperties": {
        ".+/": { "$ref": "#/$defs/folder_content" },
        "test_.+\\.py": { "$ref": "#/$defs/file_content" }
      }
    },

    "file_content": {
      "allOf": [
        {
          "if": { "type": "string" },
          "then": { "$ref": "#/$defs/skipped_declaration" }
        },
        {
          "if": { "type": "object" },
          "then": { "$ref": "#/$defs/classes_object" }
        }
      ]
    },

    "classes_object": {
      "patternProperties": {
        "Test_.+": {
          "$comment": "Value can be a version number, a skip reason, or an object with weblog variant as keys",
          "allOf": [
            {
              "if": { "type": "string" },
              "then": { "$ref": "#/$defs/feature_state" }
            },

            {
              "if": { "type": "object" },
              "then": { "$ref": "#/$defs/declaration_per_weblog" }
            }
          ]
        }
      }
    },

    "declaration_per_weblog": {
      "$comment": "Keys are weblog variant names, values are version, or a skip reason",
      "patternProperties": {
        ".+": { "$ref": "#/$defs/feature_state" }
      }
    },

    "feature_state": {
      "oneOf": [
        { "$ref": "#/$defs/version" },
        { "$ref": "#/$defs/skipped_declaration" }
      ]
    },

    "version": { "type": "string", "pattern": "v\\d.+" },

    "skipped_declaration": {
      "type": "string",
      "pattern": "^(bug|flaky|irrelevant|missing_feature)( \\(.+\\))?$"
    }
  }
}
