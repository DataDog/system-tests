FROM alpine:latest as java_build
RUN apk --no-cache add openjdk11 --repository=http://dl-cdn.alpinelinux.org/alpine/edge/community
RUN apk add --no-cache bash
COPY utils/build/ssi/java/dd-lib-java-init-test-app/ .
RUN ./gradlew build

FROM single_step_instrumentation:ubuntu24
ARG TESTED_COMPONENTS="{}"
ENV TESTED_COMPONENTS=$TESTED_COMPONENTS

COPY --from=java_build /build/libs/k8s-lib-injection-app-0.0.1-SNAPSHOT.jar .

RUN echo "bash -c 'java -Dserver.port=18080 -jar k8s-lib-injection-app-0.0.1-SNAPSHOT.jar > test-point.log 2>&1'" > /test-point.sh
RUN chmod +x /test-point.sh
ENTRYPOINT sleep infinity


